# 前端架构与性能优化

::: tip 为什么需要性能优化

1. 57%的⽤户更在乎⽹⻚在3秒内是否完成加载

2. 52%的在线⽤户认为⽹⻚打开速度影响 到他们对⽹站的忠实度

3. 每慢1秒造成⻚⾯ PV 降低11%，⽤户满意度也随之降低降低16%

4. 近半数移动⽤户因为在10秒内仍未打开⻚⾯从⽽放弃

:::

[Google Developers 优化性能指导](https://developers.google.cn/web/fundamentals/performance/get-started)

## 性能优化学徒工

- 雅虎军规
- 缓存策略(缓存为王)
- 网站协议
- 小字为先

### 雅虎军规践行

![雅虎军规](/performance/yahoo_rules.png)

更详细阅读，[参考 雅虎军规35条](https://www.jianshu.com/p/4cbcd202a591)

### 缓存策略

分为协商缓存、强缓存。

详情请移步 [http缓存机制](/blog/http/http_1.md#http缓存机制)

### ⽹站协议

通过升级http 协议

[HTTP2 多路复用](/blog/http/http_2.md#多路复用)

浏览器请求//xx.cn/a.js-->解析域名—>HTTP连接—>服务器处理⽂件—>返回数据-->浏览器解析、渲染⽂件。Keep-Alive解决的核⼼问题就在此，⼀定时间内，同⼀域名多次请求数据，只建⽴⼀次HTTP请求，其他请求可复⽤每⼀次建⽴的连接通道，以达到提⾼请求效率的问题，⼀定时间是可以配置的。

HTTP1.1还是存在效率问题

- 第⼀个：串⾏的⽂件传输
- 第⼆个：连接数过多。

HTTP/2对同⼀域名下所有请求都是基于流，也就是说同⼀域名不管访问多少⽂件，也只建⽴⼀路连接。同样Apache的最⼤连接数为300，因为有了这个新特性，最⼤的并发就可以提升到300，⽐原来提升了60倍

### 小字为先

通过分析工具，哪里大, 对那块进行压缩优化调优，尽量小

## 渲染中的性能优化

详细流程参考 [DOM 渲染中的优化](/blog/performance/rendering_optimization.md)

::: tip 结论

尽量避免 DOM 大量的 重绘/重排

:::

## CSS阻塞问题

详细流程参考 [CSS I/O 阻塞优化](/blog/css/css_io.md)

::: tip 结论

1. CSS 会堵塞 DOM 渲染<但不会影响 DOM 的解析>

2. CSS 加载会阻塞后⾯的 js 语句的执⾏<已⾃⼰实际看到的为准>

3. CSS 会堵塞 DOMContentLoaded<同时存在css和js的时候>

:::

## 页面加载性能优化
