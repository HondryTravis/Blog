---
title: JS | 你知道的JS
---

import { HighLight } from '../common/index.mdx'

修改一下，如何使下列等式成立？ 🤔

```js
function usr(name, age){
    this.name = name
    this.age = age
}

console.log(new usr('李4', 20) + new usr('赵2', 40))
// new usr('李4', 20) 李4赵2

console.log(new usr('赵2', 40) / new usr('李4', 20))
// 2
```

## 原始值 toPrimitive

[Symbol.toPrimitive](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toPrimitive) 是一个内置的 Symbol 值，它是作为对象的函数值属性存在的，当一个对象转换为对应的原始值时，会调用此函数

在 Symbol.toPrimitive 属性(用作函数值)的帮助下，一个对象可被转换为原始值。该函数被调用时，会被传递一个字符串参数 hint ，表示要转换到的原始值的预期类型。 hint 参数的取值是 "number"、"string" 和 "default" 中的任意一个

所以这个问题可以改成

```js
function usr(name, age){
  this.name = name
  this.age = age
  this[Symbol.toPrimitive] = function(hint) {
    switch (hint) {
      case 'number':
        return this.age
      default:
        return this.name
    }
  }
}
```

在看个例子, 如何使该等式成立

```js
var a;
// 修改一下
if(a === 1 && a === 2 & a === 3){
  // 需要执行这里
  console.log('dosomthing')
}
```

我们也可以这样做,当然我们也可以使用 valueOf/toString 的方式去修改

```js
var a = {
  i: 0,
  [Symbol.toPrimitive]:function(hint){
    return ++this.i
  }
}
if(a === 1 && a === 2 & a === 3){
  // 需要执行这里
  console.log('dosomthing')
}
```

## a 是什么

```js
function foo(){
  try{
    var a = 50
    throw ""
  }catch(e){
    console.log(a)
    var a = 250
  }
}
foo()
```

因为在执行函数 foo 的时候创建了一个单独的 EC 栈帧，在抛出异常的时候，栈帧内 Local 的 a 为 50.在抛出异常前， 所以 console.log 的结果是 50

## break 能退出所有循环么

```js
for(let i = 0; i< 10; i++) {
console.log(i)
  for(let j = 0; j < 10; j ++) {
    if(j > 2) {
      break // ? 这里能直接跳出这个循环么，执行下边 sucess
    }
    console.log(j)
  }
}
console.log('success')
// 答案是不可以
```
如何修改呢？先了解下标签声明

### 标签声明

JavaScript中的标签就是一个标识符。标签可以与变量重名而互不影响，因为它是另一种独立的语法元素（既不是变量，也不是类型），其作用是指示“标签化语句（labeled statement）”。

而它的声明也很简单：一个标识符后面跟一个冒号“：”。可以在多数语句前面加上这样的标签以使该语句被“标签化（labeled）”，

<HighLight>但是标签语句不能用作注释语句、模块导入, 实际上表示一个“语句/语句块”</HighLight>

在 JavaScript 中，标签只能被 break 语句与 continue 语句所引用。前者表明停止语句执行，并跳转到 break 所指示标签的范围之外；后者表明停止当前循环，并跳转到continue所指示标签的范围起点


```js
// 带标签的代码块
test: {
  console.log(2222)
}
// 不带标签的代码块
{
  console.log(3333)
}
```

所以上述例子可以修改为:

```js
out: for(let i = 0; i< 10; i++) {
console.log(i)
  for(let j = 0; j < 10; j ++) {
    if(j > 2) {
      break out
    }
    console.log(j)
  }
}
// fine
console.log('success')

// 或者 在外层循环在加上 break
for(let i = 0; i< 10; i++) {
  console.log(i)
  for(let j = 0; j < 10; j ++) {
    if(j > 2) {
      break
    }
    console.log(j)
  }
  break
}
// fine
console.log('success')
// 当然也可以修改为 使用 return 语句退出, 但是大多数时候，我们可能需要执行后边的 success

function test() {
  for(let i = 0; i< 10; i++) {
    console.log(i)
    for(let j = 0; j < 10; j ++) {
      if(j > 2) {
        return
      }
      console.log(j)
    }
  }
  console.log('success')
}

```

## 逗号运算符

```js
const a = ('hellojs', 20)
console.log(a) // ??
```

逗号运算符是二元运算符，它能够先执行运算符左侧的操作数，然后再执行右侧的操作数，最后返回右侧操作数的值

所以 a 最后的结果是 20
